%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Journal Article
% LaTeX Template
% Version 1.4 (15/5/16)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Frits Wenneker (http://www.howtotex.com) with extensive modifications by
% Vel (vel@LaTeXTemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[twoside,twocolumn]{article}

%\usepackage{booktabs,caption}
\usepackage[flushleft]{threeparttable}
\usepackage{graphicx}
\usepackage{blindtext} % Package to generate dummy text throughout this template 

\usepackage[sc]{mathpazo} % Use the Palatino font
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\linespread{1.05} % Line spacing - Palatino needs more space between lines
\usepackage{microtype} % Slightly tweak font spacing for aesthetics

\usepackage[english]{babel} % Language hyphenation and typographical rules

\usepackage[hmarginratio=1:1,top=32mm,columnsep=20pt, left= 2.35cm, right = 2.35cm, footskip = 2cm]{geometry} % Document margins
\usepackage[hang, small,labelfont=bf,up,textfont=it,up]{caption} % Custom captions under/above floats in tables or figures
\usepackage{booktabs} % Horizontal rules in tables

\usepackage{lettrine} % The lettrine is the first enlarged letter at the beginning of the text

\usepackage{enumitem} % Customized lists
\setlist[itemize]{noitemsep} % Make itemize lists more compact

\usepackage{abstract} % Allows abstract customization
\renewcommand{\abstractnamefont}{\normalfont\bfseries} % Set the "Abstract" text to bold
\renewcommand{\abstracttextfont}{\normalfont\small\itshape} % Set the abstract itself to small italic text

\usepackage{titlesec} % Allows customization of titles
\renewcommand\thesection{\Roman{section}} % Roman numerals for the sections
\renewcommand\thesubsection{\roman{subsection}} % roman numerals for subsections
\titleformat{\section}[block]{\large\scshape\centering}{\thesection.}{1em}{} % Change the look of the section titles
\titleformat{\subsection}[block]{\large}{\thesubsection.}{1em}{} % Change the look of the section titles

\usepackage{fancyhdr} % Headers and footers
\pagestyle{fancy} % All pages have headers and footers
\fancyhead{} % Blank out the default header
\fancyfoot{} % Blank out the default footer
%\fancyhead[C]{Running title $\bullet$ May 2016 $\bullet$ Vol. XXI, No. 1} % Custom header text
\fancyfoot[RO,RE]{\thepage} % Custom footer text

\usepackage{titling} % Customizing the title section

\usepackage{hyperref} % For hyperlinks in the PDF

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\setlength{\droptitle}{-4\baselineskip} % Move the title up

\pretitle{\begin{center}\huge\bfseries} % Article title formatting
\posttitle{\end{center}} % Article title closing formatting
\title{Studies of Phase Transitions in Magnetic Fields } % Article title

\author{%
\textsc{Andreas Fagerheim}\thanks{\url{https://github.com/AndreasFagerheim/Project-4}} \\[1ex] % Your name
\normalsize Department of Physics, University of Oslo, Norway \\ % Your institution
%\normalsize \href{mailto:john@smith.com}{john@smith.com} % Your email address
%\and % Uncomment if 2 authors are required, duplicate these 4 lines if more
%\textsc{Jane Smith}\thanks{Corresponding author} \\[1ex] % Second author's name
%\normalsize University of Utah \\ % Second author's institution
%\normalsize \href{mailto:jane@smith.com}{jane@smith.com} % Second author's email address
}
\date{\today} % Leave empty to omit a date

%---------------------------------------------------------------------------------------
\renewcommand{\maketitlehookd}{%
\begin{abstract}

This article set forth to integrate a six-dimensional integral which is 
used to determine the ground state
correlation energy between two electrons in a helium atom.  The
integral appears in many quantum mechanical applications. We will first solve the integral through a brute force manner using Gauss Quadrature (Gauss-Legendre) and Monte Carlo method. By changing coordinate frame and choosing a better suited probability distribution function (PDF) we implemented improved methods respectively Gauss-Laguerre and Monte Carlo with Importance Sampling. This article will show that by doing these implementations of improvement we can get better precision off our numerical methods for integration. All programs developed and used are available in the github link in the footnote.


\end{abstract}
}

%----------------------------------------------------------------------------------------

\begin{document}
\maketitle

\section{Introduction}

The aim of this project is to study a widely popular model to simulate phase transitions, the so-called Ising model in two dimensions. At a given critical temperature, this model exhbits a phase transition from a magnetic phase (a system with a finite magnetic moment) to a phase with zero magnetization.
This is a so-called binary system where the objects at each lattice site can only take two values. These could be $0$ and $1$ or other values. Here we will use spins pointing up or down as the model for our system. But we could replace the spins with blue and green balls for example.
The \href{{https://en.wikipedia.org/wiki/Ising_model}}{Ising model} has been extremely popular, with applications spanning from studies of phase transitions to simulations in statistics. In one and two dimensions its has analytical solutions to several expectation values and it gives a qualitatively  good underatanding of several types of phase transitions.  


 We will assume that we have a ferromagnetic
ordering, viz $J> 0$.  We will use periodic boundary conditions and
the Metropolis algorithm only.

\section{Theory}


\subsection{ Ising Model }
The total energy of the Ising Model can in the simplest form be expressed as

\[
E=-J\sum_{< kl >}^{N}s_ks_l - B \sum_{ k }^{N}s_k
\]
with
$s_k=\pm 1$. The quantity $N$ represents the total number of spins and $J$ is a coupling
constant expressing the strength of the interaction between
neighboring spins.  The symbol $<kl>$ indicates that we sum over
nearest neighbors only. $B$ is an external magnetic field interacting with the magnetic moment set up by the spins \cite{Hjorth-Jensen:2015dg}. This article will look closer at the case of witch there is no interacting external magnetic field and the energy can the be expressed as:
\begin{equation}
E=-J\sum_{< kl >}^{N}s_ks_l
\end{equation}

The expectation value, the mean energy, can be calculated given a probability distribution $P_i$ as
\begin{equation}
\langle E \rangle=  \sum_{i= 1}^{M} E_iP_i(\beta)
\end{equation}
hvor the probability distribution is given by the Boltzmann distribution
\[
P_i(\beta) = \frac{ e^{-\beta E_i}}{Z}
\]
where $\beta = 1/k_bT$ is the inverse temperature, $k_b$ is the Boltzmann constant, $E_i$ is is the energy of a microstate $i$. The partition function is $Z$ and is given for the canonical ensemble as a sum over all microstates, M; 
\[
Z = \sum_{i= 1}^{M} e^{-\beta E_i}.
\]
Further the the expectation values for magnetic moment $|M|$
\begin{equation}
\langle |M| \rangle=  \sum_{i= 1}^{M} M_iP_i(\beta).
\end{equation}
The variance of $E$ and $|M|$ is given receptively as 

\[
 \sigma_E^2 = \langle E^2 \rangle -\langle E \rangle^2
 \]
 \[
 \sigma_M^2 = \langle M^2 \rangle -\langle M \rangle^2
\]
This lets us express the specific heat capacity constant volume as

\begin{equation}
 C_v = \frac{1}{k_bT^2} (\langle E^2 \rangle -\langle E \rangle^2)
\end{equation}

\begin{equation}
 \chi = \frac{1}{k_bT} (\langle M^2 \rangle -\langle M \rangle^2)
\end{equation}
\subsection{ Analytic solutions for the Ising Model of 2x2 lattice }
Looking closer at a 2x2 lattice to find analytical solutions which will serve as a bechmark for the method implemented later with T = 1. \textbf{Table 1} shows the different energies and magnetization states. Using the known states we can find analytical solutions:

\[
Z = \sum_{i= 1}^{M} e^{-\beta E_i} = 2e^{\beta8J}+2e^{-8\beta J}+12e^0.
\]
with $\beta = 1/kT$ and $T = 1$ with unit $kT/J$ we get:
\[
Z = 2e^{8}+2e^{-8}+12e^0.
\]
\begin{table}[h]
  \begin{threeparttable}
    \caption{The different energy states of the 2x2 Ising Model}
     \begin{tabular}{lllll}
        \toprule
        No. of spins & Degeneracy & Energy & Magnetization &  \\
        \midrule
                
        4    & 1        & -8J   & 4       	   \\
        3    & 4        &  0    & 2          \\
        2    & 4        &  0    & 0          \\
        2    & 2        &  8J   & 0          \\
        1    & 4        &  0    & -2          \\
        0    & 1        & -8J   & -4          \\
        \bottomrule
     \end{tabular}
    \begin{tablenotes}
      \small
      \item Showing the different energy and magnetization for the two-dimensional Ising model with periodic boundary conditions.
    \end{tablenotes} 
  \end{threeparttable}
  
\end{table}

This gives us the energy
\begin{equation}
\langle E \rangle=  \sum_{i= 1}^{M} E_iP_i(\beta) =\frac{1}{Z} \sum_{i= 1}^{M} E_ie^{-\beta E_i}
\end{equation}
\[
\langle E \rangle=  \frac{1}{Z}(-8e^8 +8e^{-8} +8e^{-8}-8e^{8}) = -7.9839
\]
\[
\frac{\langle E \rangle}{N}= -1.99598
\]
hvor $N = 4$. In the same way the magnetization turns out to be

\begin{equation}
\langle |M|\rangle=  \frac{1}{Z}\sum_{i= 1}^{M} M_i e^{E_i} = 3.9946
\end{equation}
\[
\frac{\langle |M| \rangle}{N}= 0.9986
\]
The heat capacity then becomes:
\begin{equation}
\langle E^2 \rangle= \frac{1}{Z} \sum_{i= 1}^{M} E_i^2e^{E_i}= \frac{128e^8+128e^{-8}}{5973.917}
\end{equation}
\[
\frac{C_V}{N} = \frac{\langle E^2 \rangle -{\langle E \rangle}^2}{4}= 0.12832 = 0.03208
\]
The magnetic susceptibility  can in the same way be calculated to $\frac{\chi}{N} = 0.00401$.


\subsection{Studies of phase transitions.}
Near $T_C$ we can characterize the behavior of many physical quantities
by a power law behavior.
As an example, for the Ising class of models, 
the mean magnetization is given by
\[
  \langle M(T) \rangle \sim \left(T-T_C\right)^{\beta},
\]
where $\beta=1/8$ is a so-called critical exponent. A similar relation
applies to the heat capacity

\[
  C_V(T) \sim \left|T_C-T\right|^{\alpha},
\]
and the susceptibility
\begin{equation}
  \chi(T) \sim \left|T_C-T\right|^{\gamma},
\end{equation}
with $\alpha = 0$ and $\gamma = 7/4$.
Another important quantity is the correlation length, which is expected
to be of the order of the lattice spacing for $T>> T_C$. Because the spins
become more and more correlated as $T$ approaches $T_C$, the correlation
length increases as we get closer to the critical temperature. The divergent
behavior of $\xi$ near $T_C$ 
is

\begin{equation}
  \xi(T) \sim \left|T_C-T\right|^{-\nu}.
  \label{eq:xi}
\end{equation}
A second-order phase transition is characterized by a
correlation length which spans the whole system.
Since we are always limited to a finite lattice, $\xi$ will
be proportional with the size of the lattice. 
Through so-called finite size scaling relations
it is possible to relate the behavior at finite lattices with the 
results for an infinitely large lattice.
The critical temperature scales then as

\begin{equation}
 T_C(L)-T_C(L=\infty) = aL^{-1/\nu},
 \label{eq:tc}
\end{equation}
with  $a$ a constant and  $\nu$ defined in Eq. (\ref{eq:xi}).
We set $T=T_C$ and obtain a mean magnetisation

\begin{equation}
  \langle {\cal M}(T) \rangle \sim \left(T-T_C\right)^{\beta}
  \rightarrow L^{-\beta/\nu},
  \label{eq:scale1}
\end{equation}
a heat capacity

\begin{equation}
  C_V(T) \sim \left|T_C-T\right|^{-\gamma} \rightarrow L^{\alpha/\nu},
  \label{eq:scale2}
\end{equation}
and susceptibility

\begin{equation}
  \chi(T) \sim \left|T_C-T\right|^{-\alpha} \rightarrow L^{\gamma/\nu}.
  \label{eq:scale3}
\end{equation}
\section{Methods}


%------------------------------------------------

\section{Results}
\begin{table}[]
\begin{tabular}{|l|l|l|l|l|}
\hline
MC cycles &  ${E}/{N}$   & ${C_V}/{N}$    & ${|M|}/{N}$      & $ \chi/{N} $     \\ \hline
Analytisk & -1.9959 & 0.03208   & 0.9986   & 0.00401  \\ \hline
20000     & -1.9951 & 0.03910 & 0.9983 & 0.005288 \\ \hline
40000     & -1.9966 & 0.02755 & 0.9988 & 0.003669 \\ \hline
60000     & -1.9966 & 0.02715 & 0.9988 & 0.003345 \\ \hline
80000     & -1.9964 & 0.02875 & 0.9987 & 0.003707 \\ \hline
100000    & -1.9966 & 0.02699 & 0.9989 & 0.003455 \\ \hline
\end{tabular}
\caption{Comparison of the analytical values and the numerical values with increasing number of Monte Carlo cycles.}
\label{tab:my-table}
\end{table}


\section{Conclusion}

%----------------------------------------------------------------------------------------
%	REFERENCE LIST
%----------------------------------------------------------------------------------------

\begin{thebibliography}{99} % Bibliography - this is intentionally simple in this template
%A statement requiring citation \cite{Hjorth-Jensen:2015dg}.
\bibitem[Hjorth-Jensen, 2015]{Hjorth-Jensen:2015dg}
Hjort-Jensen, M. (2015).
\newblock Computational Physics.
\bibitem[Hjorth-Jensen]{Hjorth-Jensen}
Hjort-Jensen, M.
\newblock https://github.com/CompPhysics/ComputationalPhysics

 
\end{thebibliography}

%----------------------------------------------------------------------------------------

\end{document}
